<!DOCTYPE html>
<html lang="es">
<head>
  <meta charset="UTF-8" />
  <title>Admin ‚Ä¢ Dashboard</title>
  <meta name="viewport" content="width=device-width, initial-scale=1" />

  <style>
    :root {
      --bg: #020617;
      --card: #020617;
      --border: #1e293b;
      --muted: #94a3b8;
      --accent: #22c55e;
      --danger: #dc2626;
      --sidebar: #020617;
    }

    * { box-sizing: border-box; }

    body {
      margin: 0;
      background: var(--bg);
      color: white;
      font-family: system-ui, sans-serif;
    }

    /* ===== LAYOUT ===== */
    .layout {
      display: flex;
      min-height: 100vh;
    }

    /* ===== SIDEBAR ===== */
    .sidebar {
      width: 240px;
      background: var(--sidebar);
      border-right: 1px solid var(--border);
      padding: 20px 16px;
      display: flex;
      flex-direction: column;
      gap: 20px;
    }

    .logo {
      font-size: 18px;
      font-weight: bold;
      text-align: center;
      padding-bottom: 12px;
      border-bottom: 1px solid var(--border);
    }

    .menu {
      display: flex;
      flex-direction: column;
      gap: 6px;
    }

    .menu a {
      text-decoration: none;
      color: white;
      padding: 10px 12px;
      border-radius: 8px;
      font-size: 14px;
      display: flex;
      gap: 10px;
      align-items: center;
    }

    .menu a:hover {
      background: rgba(255,255,255,0.05);
    }

    .menu a.active {
      background: rgba(34,197,94,0.15);
      color: var(--accent);
    }

    .sidebar-footer {
      margin-top: auto;
    }

    .logout-btn {
      width: 100%;
      background: transparent;
      border: 1px solid var(--border);
      color: white;
      padding: 10px;
      border-radius: 8px;
      cursor: pointer;
    }

    /* ===== CONTENT ===== */
    .content {
      flex: 1;
      padding: 20px;
      max-width: 1200px;
      margin: auto;
    }

    h1 { margin-top: 0; }

    /* ===== STATS ===== */
    .stats {
      display: grid;
      grid-template-columns: repeat(auto-fit, minmax(220px, 1fr));
      gap: 16px;
      margin-bottom: 24px;
    }

    .stat {
      background: var(--card);
      border: 1px solid var(--border);
      border-radius: 14px;
      padding: 18px;
    }

    .stat span {
      color: var(--muted);
      font-size: 13px;
    }

    .stat strong {
      font-size: 28px;
      display: block;
      margin-top: 6px;
    }

    /* ===== TABLE ===== */
    .card {
      background: var(--card);
      border: 1px solid var(--border);
      border-radius: 12px;
      padding: 16px;
    }

    table {
      width: 100%;
      border-collapse: collapse;
      min-width: 900px;
    }

    th, td {
      padding: 10px;
      border-bottom: 1px solid var(--border);
      font-size: 13px;
      text-align: left;
    }

    th {
      color: var(--muted);
      font-weight: 500;
    }

    td.numeros {
      font-size: 12px;
      color: #e5e7eb;
    }

    @media (max-width: 900px) {
      .sidebar { display: none; }
    }
  </style>
</head>

<body>

<div class="layout">

  <!-- ===== SIDEBAR ===== -->
  <aside class="sidebar">
    <div class="logo">üéõ Admin Panel</div>

    <nav class="menu">
      <a href="dashboard.html" class="active">üìä Dashboard</a>
      <a href="settings.html">‚öôÔ∏è Configuraci√≥n</a>
      <a href="index.html" target="_blank">üåê Ver sitio</a>
    </nav>

    <div class="sidebar-footer">
      <button id="logout" class="logout-btn">Cerrar sesi√≥n</button>
    </div>
  </aside>

  <!-- ===== CONTENT ===== -->
  <main class="content">

    <h1>Dashboard</h1>

    <div class="stats">
      <div class="stat">
        <span>Total compras</span>
        <strong id="totalCompras">0</strong>
      </div>
      <div class="stat">
        <span>Total tickets</span>
        <strong id="totalTickets">0</strong>
      </div>
      <div class="stat">
        <span>Total vendido (Bs)</span>
        <strong id="totalBolivares">0 Bs</strong>
      </div>
    </div>

    <div class="card">
      <h2>Compras registradas</h2>
      <div style="overflow-x:auto">
        <table id="tablaCompras">
          <thead>
            <tr>
              <th>Nombre</th>
              <th>Tel√©fono</th>
              <th>Correo</th>
              <th>C√©dula</th>
              <th>Tickets</th>
              <th>Referencia</th>
              <th>N√∫meros</th>
              <th>Fecha</th>
            </tr>
          </thead>
          <tbody></tbody>
        </table>
      </div>
    </div>

  </main>
</div>

<!-- AUTH -->
<script type="module">
  import { auth } from "../firebase.js";
  import { onAuthStateChanged, signOut }
    from "https://www.gstatic.com/firebasejs/10.12.5/firebase-auth.js";

  onAuthStateChanged(auth, user => {
    if (!user) window.location.href = "login.html";
  });

  document.getElementById("logout").onclick = async () => {
    await signOut(auth);
    window.location.href = "login.html";
  };
</script>

<!-- FIRESTORE (igual al tuyo) -->
<script type="module">
  import { db } from "../firebase.js";
  import { collection, getDocs, query, orderBy }
    from "https://www.gstatic.com/firebasejs/10.12.5/firebase-firestore.js";

  const tbody = document.querySelector("#tablaCompras tbody");
  const totalComprasEl = document.getElementById("totalCompras");
  const totalTicketsEl = document.getElementById("totalTickets");
  const totalBolivaresEl = document.getElementById("totalBolivares");

  const PRECIO_TICKET = 219;

  async function cargarCompras() {
    let compras = 0, tickets = 0, bolivares = 0;
    tbody.innerHTML = "";

    const q = query(collection(db,"compras"), orderBy("fecha","desc"));
    const snap = await getDocs(q);

    snap.forEach(d => {
      const data = d.data();
      compras++;
      tickets += data.tickets || 0;
      bolivares += (data.tickets || 0) * PRECIO_TICKET;

      const tr = document.createElement("tr");
      tr.innerHTML = `
        <td>${data.nombre || "-"}</td>
        <td>${data.telefono || "-"}</td>
        <td>${data.correo || "-"}</td>
        <td>${data.cedula || "-"}</td>
        <td>${data.tickets || 0}</td>
        <td>${data.referencia || "-"}</td>
        <td class="numeros">${(data.numeros || []).join(", ")}</td>
        <td>${data.fecha?.toDate().toLocaleString() || "-"}</td>
      `;
      tbody.appendChild(tr);
    });

    totalComprasEl.textContent = compras;
    totalTicketsEl.textContent = tickets;
    totalBolivaresEl.textContent = bolivares + " Bs";
  }

  cargarCompras();
</script>

</body>
</html>







